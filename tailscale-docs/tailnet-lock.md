# Tailnet Lock

**Source:** https://tailscale.com/kb/1226/tailnet-lock

---

## Overview

Security feature ensuring only trusted nodes can join your TAILSCALE network. Prevents unauthorized nodes even if Tailscale infrastructure were compromised.

## Core Concept

Trusted nodes sign and verify other nodes. No need to trust Tailscale coordination server for distributing public node keys.

**Trust Model:** Trust on first use (TOFU). After setup, trust centers on customer-controlled nodes.

## Key Components

### Node Keys vs. Tailnet Lock Keys (TLK)
- **Node keys** - Generated by Tailscale clients, tied to device identity
- **TLK** - Public/private pairs on every node; trusted copies in tailnet key authority

### Signing Nodes
Nodes authorized to cryptographically sign new additions.

### Tailnet Key Authority (TKA)
Storage for trusted TLK sets, verifying signatures and authorization changes.

## Requirements

- Owner, Admin, or IT admin role
- Tailscale v1.46.1+
- Minimum two signing nodes

## Setup

### 1. Initialize (Admin Console)
Device Management > Generate `tailscale lock init` command.

### 2. Run Command
```bash
tailscale lock init
```

Generates 10 disablement secrets - **store securely!**

### 3. Add Signing Nodes
```bash
tailscale lock add tlpub:key1
tailscale lock add tlpub:key2
```

### 4. Sign New Nodes
```bash
tailscale lock sign nodekey:xxx
```

## Management

```bash
tailscale lock status              # Check status
tailscale lock add tlpub:xxx       # Add signing node
tailscale lock remove tlpub:xxx    # Remove signing node
tailscale lock revoke-keys         # Revoke compromised keys
```

## Limitations

- Maximum 20 signing nodes
- Cannot coexist with device approval
- Keys stored locally (device compromise exposes keys)
- Android cannot be signing nodes
- Annual TLK rotation recommended

## Use Cases for TAILSCALE Nodes

- Maximum security for production nodes
- Cryptographic verification of all node additions
- Protection against coordination server compromise
